// Mapping of Portuguese districts to their municipalities (counties)
// Extracted from portugal-municipalities-simplified.geojson

export const PORTUGAL_DISTRICTS: Record<string, string[]> = {
  "Aveiro": [
    "Albergaria-a-Velha",
    "Anadia",
    "Arouca",
    "Aveiro",
    "Castelo de Paiva",
    "Espinho",
    "Estarreja",
    "Mealhada",
    "Murtosa",
    "Oliveira de Azeméis",
    "Oliveira do Bairro",
    "Ovar",
    "Santa Maria da Feira",
    "Sever do Vouga",
    "São João da Madeira",
    "Vagos",
    "Vale de Cambra",
    "Águeda",
    "Ílhavo"
  ],
  "Açores": [
    "Angra do Heroísmo",
    "Calheta de São Jorge",
    "Corvo",
    "Horta",
    "Lagoa",
    "Lajes das Flores",
    "Lajes do Pico",
    "Madalena",
    "Nordeste",
    "Ponta delgada",
    "Povoação",
    "Praia da Vitória",
    "Ribeira Grande",
    "Santa Cruz da Graciosa",
    "Santa Cruz das Flores",
    "São Roque do Pico",
    "Velas",
    "Vila Franca do Campo",
    "Vila do Porto"
  ],
  "Beja": [
    "Aljustrel",
    "Almodôvar",
    "Alvito",
    "Barrancos",
    "Beja",
    "Castro Verde",
    "Cuba",
    "Ferreira do Alentejo",
    "Moura",
    "Mértola",
    "Odemira",
    "Ourique",
    "Serpa",
    "Vidigueira"
  ],
  "Braga": [
    "Amares",
    "Barcelos",
    "Braga",
    "Cabeceiras de Basto",
    "Celorico de Basto",
    "Esposende",
    "Fafe",
    "Guimarães",
    "Póvoa de Lanhoso",
    "Terras de Bouro",
    "Vieira do Minho",
    "Vila Nova de Famalicão",
    "Vila Verde",
    "Vizela"
  ],
  "Bragança": [
    "Alfândega da Fé",
    "Bragança",
    "Carrazeda de Ansiães",
    "Freixo de Espada À Cinta",
    "Macedo de Cavaleiros",
    "Miranda do douro",
    "Mirandela",
    "Mogadouro",
    "Torre de Moncorvo",
    "Vila Flor",
    "Vimioso",
    "Vinhais"
  ],
  "Castelo Branco": [
    "Belmonte",
    "Castelo Branco",
    "Covilhã",
    "Fundão",
    "Idanha-a-Nova",
    "Oleiros",
    "Penamacor",
    "Proença-a-Nova",
    "Sertã",
    "Vila Velha de Ródão",
    "Vila de Rei"
  ],
  "Coimbra": [
    "Arganil",
    "Cantanhede",
    "Coimbra",
    "Condeixa-a-Nova",
    "Figueira da Foz",
    "Góis",
    "Lousã",
    "Mira",
    "Miranda do Corvo",
    "Montemor-o-Velho",
    "Oliveira do Hospital",
    "Pampilhosa da Serra",
    "Penacova",
    "Penela",
    "Soure",
    "Tábua",
    "Vila Nova de Poiares"
  ],
  "Faro": [
    "Albufeira",
    "Alcoutim",
    "Aljezur",
    "Castro Marim",
    "Faro",
    "Lagoa",
    "Lagos",
    "Loulé",
    "Monchique",
    "Olhão",
    "Portimão",
    "Silves",
    "São Brás de Alportel",
    "Tavira",
    "Vila Real de Santo António",
    "Vila do Bispo"
  ],
  "Guarda": [
    "Aguiar da Beira",
    "Almeida",
    "Celorico da Beira",
    "Figueira de Castelo Rodrigo",
    "Fornos de Algodres",
    "Gouveia",
    "Guarda",
    "Manteigas",
    "Mêda",
    "Pinhel",
    "Sabugal",
    "Seia",
    "Trancoso",
    "Vila Nova de Foz Côa"
  ],
  "Leiria": [
    "Alcobaça",
    "Alvaiázere",
    "Ansião",
    "Batalha",
    "Bombarral",
    "Caldas da Rainha",
    "Castanheira de Pêra",
    "Figueiró dos Vinhos",
    "Leiria",
    "Marinha Grande",
    "Nazaré",
    "Pedrógão Grande",
    "Peniche",
    "Pombal",
    "Porto de Mós",
    "Óbidos"
  ],
  "Lisboa": [
    "Alenquer",
    "Amadora",
    "Arruda dos Vinhos",
    "Azambuja",
    "Cadaval",
    "Cascais",
    "Lisboa",
    "Loures",
    "Lourinhã",
    "Mafra",
    "Odivelas",
    "Oeiras",
    "Sintra",
    "Sobral de Monte Agraço",
    "Torres Vedras",
    "Vila Franca de Xira"
  ],
  "Madeira": [
    "Calheta",
    "Câmara de Lobos",
    "Funchal",
    "Machico",
    "Ponta do Sol",
    "Porto Moniz",
    "Porto Santo",
    "Ribeira Brava",
    "Santa Cruz",
    "Santana",
    "São Vicente"
  ],
  "Portalegre": [
    "Alter do Chão",
    "Arronches",
    "Avis",
    "Campo Maior",
    "Castelo de Vide",
    "Crato",
    "Elvas",
    "Fronteira",
    "Gavião",
    "Marvão",
    "Monforte",
    "Nisa",
    "Ponte de Sor",
    "Portalegre",
    "Sousel"
  ],
  "Porto": [
    "Amarante",
    "Baião",
    "Felgueiras",
    "Gondomar",
    "Lousada",
    "Maia",
    "Marco de Canaveses",
    "Matosinhos",
    "Paredes",
    "Paços de Ferreira",
    "Penafiel",
    "Porto",
    "Póvoa de Varzim",
    "Santo Tirso",
    "Trofa",
    "Valongo",
    "Vila Nova de Gaia",
    "Vila do Conde"
  ],
  "Santarém": [
    "Abrantes",
    "Alcanena",
    "Almeirim",
    "Alpiarça",
    "Benavente",
    "Cartaxo",
    "Chamusca",
    "Constância",
    "Coruche",
    "Entroncamento",
    "Ferreira do Zêzere",
    "Golegã",
    "Mação",
    "Ourém",
    "Rio Maior",
    "Salvaterra de Magos",
    "Santarém",
    "Sardoal",
    "Tomar",
    "Torres Novas",
    "Vila Nova da Barquinha"
  ],
  "Setúbal": [
    "Alcochete",
    "Alcácer do Sal",
    "Almada",
    "Barreiro",
    "Grândola",
    "Moita",
    "Montijo",
    "Palmela",
    "Santiago do Cacém",
    "Seixal",
    "Sesimbra",
    "Setúbal",
    "Sines"
  ],
  "Viana do Castelo": [
    "Arcos de Valdevez",
    "Caminha",
    "Melgaço",
    "Monção",
    "Paredes de Coura",
    "Ponte da Barca",
    "Ponte de Lima",
    "Valença",
    "Viana do Castelo",
    "Vila Nova de Cerveira"
  ],
  "Vila Real": [
    "Alijó",
    "Boticas",
    "Chaves",
    "Mesão Frio",
    "Mondim de Basto",
    "Montalegre",
    "Murça",
    "Peso da Régua",
    "Ribeira de Pena",
    "Sabrosa",
    "Santa Marta de Penaguião",
    "Valpaços",
    "Vila Pouca de Aguiar",
    "Vila Real"
  ],
  "Viseu": [
    "Armamar",
    "Carregal do Sal",
    "Castro daire",
    "Cinfães",
    "Lamego",
    "Mangualde",
    "Moimenta da Beira",
    "Mortágua",
    "Nelas",
    "Oliveira de Frades",
    "Penalva do Castelo",
    "Penedono",
    "Resende",
    "Santa Comba Dão",
    "Sernancelhe",
    "Sátão",
    "São João da Pesqueira",
    "São Pedro do Sul",
    "Tabuaço",
    "Tarouca",
    "Tondela",
    "Vila Nova de Paiva",
    "Viseu",
    "Vouzela"
  ],
  "Évora": [
    "Alandroal",
    "Arraiolos",
    "Borba",
    "Estremoz",
    "Montemor-o-Novo",
    "Mora",
    "Mourão",
    "Portel",
    "Redondo",
    "Reguengos de Monsaraz",
    "Vendas Novas",
    "Viana do Alentejo",
    "Vila Viçosa",
    "Évora"
  ]
}

// Get all districts
export const ALL_DISTRICTS = Object.keys(PORTUGAL_DISTRICTS).sort()

// Get all counties
export const ALL_COUNTIES = Object.values(PORTUGAL_DISTRICTS).flat().sort()

// Get counties for selected districts
export function getCountiesForDistricts(districts: string[]): string[] {
  if (!districts || districts.length === 0) {
    return []
  }

  const counties = new Set<string>()
  for (const district of districts) {
    const districtCounties = PORTUGAL_DISTRICTS[district]
    if (districtCounties) {
      for (const county of districtCounties) {
        counties.add(county)
      }
    }
  }

  return Array.from(counties).sort()
}

// Get districts from selected counties
// Returns districts where ALL municipalities of that district are selected
export function getFullySelectedDistricts(counties: string[]): string[] {
  if (!counties || counties.length === 0) {
    return []
  }

  const countySet = new Set(counties)
  const fullySelectedDistricts: string[] = []

  for (const [district, municipalities] of Object.entries(PORTUGAL_DISTRICTS)) {
    const allSelected = municipalities.every(m => countySet.has(m))
    if (allSelected) {
      fullySelectedDistricts.push(district)
    }
  }

  return fullySelectedDistricts
}

// Get district for a specific county
export function getDistrictForCounty(county: string): string | null {
  for (const [district, municipalities] of Object.entries(PORTUGAL_DISTRICTS)) {
    if (municipalities.includes(county)) {
      return district
    }
  }
  return null
}

// Get all unique districts that contain any of the selected counties
export function getDistrictsFromCounties(counties: string[]): string[] {
  if (!counties || counties.length === 0) {
    return []
  }

  const districts = new Set<string>()
  for (const county of counties) {
    const district = getDistrictForCounty(county)
    if (district) {
      districts.add(district)
    }
  }

  return Array.from(districts)
}
